
{% extends '_layout.twig' %}


{% block title %}Annonces{% endblock %}

{% block javascripts %}
<script src="js/jquery-3.7.1.min.js"></script>
<script src="js/jquery-ui.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function(){

    $('#sliderPrice').slider({
        range: true,
        min:0,
        max:60000,
        values:[1000,50000],
        stop:function(event,ui){
            
            let min = ui.values[0];
            let max = ui.values[1];

            console.log(min);
            console.log(max);

            $('#range').text(min+' - '+max);

            $.ajax({
                url: '/announces',
                method: 'POST',
                data: {
                    min:min,
                    max:max
                },
                dataType:'json'

            }) //ajax
            .done(function(response){
            
                    $('#test').empty();
                    response.forEach(function(item,index,array)
                    {
                        let cardVe = "card_ve_"+index;
                        $('#test').append('<article class="card col-lg-4 m-3 p-0" id='+cardVe+'></article>');
                        $('#'+cardVe).append('<div class="card-body"></div>');
                        $('#'+cardVe+'>.card-body').append('<h5 class="card-title">'+item['mo_name'] + ' ' + item['br_name']+'</h5>');
                        $('#'+cardVe+'>.card-body').append('<div class="card-text">Année: '+item['ve_year'] +'</div>');
                        $('#'+cardVe+'>.card-body').append('<div class="card-text">Kilométrage: '+item['ve_km'] +'</div>');
                        $('#'+cardVe+'>.card-body').append('<p class="card-text">Moteur: '+item['en_name'] +'</p>');
                        $('#'+cardVe+'>.card-body').append('<div class="card-text">Couleur: '+item['ve_color'] +'</div>');
                        $('#'+cardVe+'>.card-body').append('<p class="card-text">Nombre de portes: '+item['ve_doors'] +'</p>');
                        $('#'+cardVe+'>.card-body').append('<div class="card-text">Prix: '+item['ve_price'] +' €</div>');                      
                    }) //forEach

            })
            .fail(function(error){

            });
        } //slide event

    }); //slider

});// $document
</script>
{% endblock %}

{% block main %}

 <main class="container mt-3">
 <div class="search">
        <label for="customRange2" class="form-label">Example range</label>
        <span id="range"></span>        
      </div>
      <div id="sliderPrice" style="width: 20%;" ></div>
    <section class="row justify-content-sm-center justify-content-md-evenly justify-content-lg-center p-2" id="test" >
      

     {% for announce in announces %}  
        <article class="card col-lg-4 m-3 p-0">
            <img src="" class="card-img-top img-fluid " alt="" >
            <div class="card-body">
                <h5 class="card-title">{{ announce.mo_name }} {{ announce.br_name}}  </h5>
                <div class="card-text">Année: {{announce.ve_year}}</div>
                <div class="card-text"> Kilométrage: {{announce.ve_km}}</div>
                <p class="card-text">Moteur: {{ announce.en_name}} </p>
                <div class="card-text">Couleur: {{ announce.ve_color}} </div>
                <p class="card-text">Nombre de portes: {{ announce.ve_doors}} </p>
                <div class="card-text">Prix: {{ announce.ve_price}} € </div> 
                
                <a href="#" class="btn btn-primary" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-title="Tooltip on top">Details</a>
            </div>
            <div class="card-footer">
                <p class="card-text"></p>
            </div>
        </article>
       {% endfor %}
    </section>
</main>
{% endblock %}
 
{% flush %}